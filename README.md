

### **织梦星枢** - 基于**SpringBoot 3 + LangChain4j** + **Vue 3**构建的AI零代码应用生成平台

> 2025.9.3-2025.10.7 基本完成该项目的构建

1.基于**SpringBoot3 + java21**构建项目，采用**MyBatis Flex**作为后端数据库访问层框架，引入**Pina**管理前端全局状态。引入Hutool、lombok、Knife4j等类库提高开发效率。

2.使用Lanchain4j + **Reactor**响应式编程，将AI返回的内容封装为**Flux**响应式对象，在上下游进行多次处理，使用**SSE流式推送**的方式实时展示AI的回复给前端

3.采用多种设计模式，包括**策略模式/模板方法模式+执行器模式**等设计思想规范AI生成方法的下游处理，使用**门面模式**提供统一调用入口，**工厂模式**提供服务实例和工具。

4.开发**静态资源**访问接口提供网站预览，使用**Nginx**提供网站的部署服务。

5.MySQL保存**对话历史**，**游标查询**加载对话历史，Langchain4j整合Redis**持久化对话记忆**，初始拉取对话历史。通过mermoryId实现多用户会话的隔离。

6.能够根据用户的提示词路由到**原生HTML、多文件、Vue工程项目**三种模式之一。前两者采用完整代码输出后解析并写入目标位置，后者采用AI调用工具的方式，让AI自主调用工具写入文件，对返回的TokenStream流获取工具流输出阶段，通知前端，并采用适配器模式统一为Flux流返回前端。

7.使用java21的**虚拟线程**对Vue工程项目进行**异步打包构建**，防止阻塞主线程。**Selenium Web自动化框架 + WebDriverManager浏览器驱动管理工具库** 对部署完成的网站以虚拟线程进行**异步截图**，压缩上传COS对象存储，作为应用封面图。

8.对修改项目，简单的HTML和多文件依然采用完整代码的输出。而对于复杂的Vue工程项目，为AI**提供读取、修改、删除的工具**，在原有代码上进行修改，同样实时通知前端修改阶段。

9.支持应用生成后**可视化修改**——以**可视化选择 + AI提示词编辑**的方式。前端基于**父子网站不同源通信**的方式，前端页面提前生成代码，触发点击事件，对iframe子网站动态注入代码触发选中效果，返回选中元素，拼接用户修改提示词返回后端对网站迭代修改。

10.整合**LangGraph4j**工作流编程框架，为项目提供另外一套技术架构的实现。定义工作节点Node，状态AgentState，边Edges，实践**CompletableFuture/Parallel Branch/子图**三种方式并发处理网站图片收集，提供4种图片收集工具，

(a)调用Pexels素材网站API收集内容图片  (b)unDraw插画网站接口收集插画  (c)Mermaid+**COS对象存储**将AI生成的文本绘图代码转为图片上传COS  (d)接入通义**万相文生图**根据AI回复绘制logo图片上传COS。

实践Langragh4j高级特性，引入**条件边**令HTML和MULTI_FILE跳过构建，**循环边**检查生成代码质量，对不能正常运行的代码进行迭代修改。

11.对系统进行一系列优化，

(1)采用**Spring多例模式**为不同的线程提供不同的ChatModel实例防止阻塞。**Redis旁路缓存**高频访问的精选案例，以Spring Data Redis提供的缓存注解实现，降低系统访问压力

(2)**Redisson**分布式限流，自定义限流注解和切面类，实现方法、用户、IP三个维度的令牌桶限流，具体到AI对话方法的用户限流。

(3)**Prompt安全性审查**，基于LangChain4的**护轨**接口，引入**输入护轨**对用户输入的内容进行安全审查，正则匹配是否存在敏感词和注入攻击。

(4)稳定性优化，引入**输出护轨**判断AI响应质量，不符合要求重新生成。提供退出工具

(5)设置工具调用次数上限，防止工具调用循环异常。为AI接入退出工具，让AI自主判断退出工具调用的情况。

(6)成本优化，对简单智能路由任务采用低成本的qwen-flash，复杂的推理应用生成任务仍采用deepseek-reasoner

12 **可观测性**，接入**阿里云ARMS系统监控，**通过Java Agent技术，在JVM启动时加载监控代理，实现无侵入式的数据收集，提供Java应用性能、调用链、请求数、平均耗时、连接池/线程池等全方位监控告警和实时诊断。

采用**Prometheus时序数据库** + **Grafana可视化监控仪表板** 对具体业务指标进行监控，包括模型调用数、Token消耗数、热门应用排行等等，通过收集最细粒度不同维度组合下的指标数据，收集并编写配置展示。

13 使用Spring Cloud Alibaba对项目进行微服务改造，拆作用户、AI、应用、截图、通用模块、数据模型几个部分，便于维护和拓展。 采用**Nacos注册中心**对服务实例进行统一管理和配置，**Dubbo**作为RPC框架和服务发现提供者。****Higress AI原生API网关**作为微服务网关统一项目入口，提供负载均衡、安全认证、限流熔断、监控日志等功能。

14 部署上线，安装**1Panel** Linux运维管理面板辅助终端操作京东云服务器，打包项目部署到服务器上，配置反向代理、购买的域名、自签证书。



-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### 本地启动所需依赖环境

1) MySQL 本地服务
2) Redis 本地服务
3) Nginx 命令行启动
4) Prometheus 命令行启动
5) Grafana 命令行启动
6) Nacos 命令行启动
##### 请确保上述依赖环境全部启动

### 用到的第三方库
1) 腾讯云 COS，需要Id、key、存储桶、访问域名、地域
2) 阿里云 DashScope，用于生成logo，需要key
3) Pexels 用于搜索内容图片，需要key
4) deepseek-chat/ deepseek-reasoner/ qwen-flash 被接入lanchain4j，需要key

